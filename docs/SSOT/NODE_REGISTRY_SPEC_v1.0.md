# NODE REGISTRY SPEC v1.0

**Unified Node Registry for AI_TEAM**

**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ**: âœ… Ð£Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¾ (Approved)
**Ð’ÐµÑ€ÑÐ¸Ñ**: 1.0
**Ð”Ð°Ñ‚Ð°**: 2025-12-15

---

## ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ð°Ñ Ð¾ÑÐ½Ð¾Ð²Ð°

**Reference Architectures**:
- **Kubernetes Node Registry** â€” ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑƒÐ·Ð»Ð°Ð¼Ð¸ ÐºÐ»Ð°ÑÑ‚ÐµÑ€Ð°
- **Kubernetes API Object Model** â€” metadata/spec/status pattern
- **etcd** â€” distributed key-value store (CNCF)
- **Consul Service Registry** â€” service discovery and health checking

**ÐŸÑ€Ð¸Ð½Ñ†Ð¸Ð¿**: **Reuse Kubernetes Architecture & Code. Zero Reinvention.**

---

## Ð¡Ð²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ (SSOT)

- [mindbus_protocol_v1.md](mindbus_protocol_v1.md) â€” Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð» ÑˆÐ¸Ð½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… (Ñ‚Ð¾Ñ‚ Ð¶Ðµ ÐºÐ°Ñ‚Ð°Ð»Ð¾Ð³ SSOT)
- [NODE_PASSPORT_SPEC_v1.0.md](NODE_PASSPORT_SPEC_v1.0.md) â€” ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚Ð° ÑƒÐ·Ð»Ð°
- [PROCESS_CARD_SPEC_v1.0.md](PROCESS_CARD_SPEC_v1.0.md) â€” ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð² (Ð±ÑƒÐ´ÑƒÑ‰Ð°Ñ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ)
- [READY_MADE_FIRST.md](../project/principles/READY_MADE_FIRST.md) â€” Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ñ… Ñ€ÐµÑˆÐµÐ½Ð¸Ð¹

---

## Ð§ÐÐ¡Ð¢Ð¬ 1. ÐšÐžÐÐ¦Ð•ÐŸÐ¢Ð£ÐÐ›Ð¬ÐÐžÐ• ÐžÐŸÐ˜Ð¡ÐÐÐ˜Ð•

### 1.1. ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Node Registry

**Node Registry** â€” ÑÑ‚Ð¾ ÐµÐ´Ð¸Ð½Ñ‹Ð¹ Ñ€ÐµÐµÑÑ‚Ñ€ Ð²ÑÐµÑ… ÑƒÐ·Ð»Ð¾Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ AI_TEAM.

**ÐŸÐ¾Ð´ ÑƒÐ·Ð»Ð¾Ð¼ (Node) Ð¿Ð¾Ð½Ð¸Ð¼Ð°ÐµÑ‚ÑÑ** Ð»ÑŽÐ±Ð¾Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸Ðº ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹:
- **AI-Ð°Ð³ÐµÐ½Ñ‚Ñ‹** (code_generation, text_generation, data_analysis, etc.)
- **ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€** (task orchestration, process management)
- **ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ / UI** (observability, dashboards)
- **Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹** (Database, Storage, Sandbox, External API)
- **Ð’Ð½ÐµÑˆÐ½Ð¸Ðµ ÑÐµÑ€Ð²Ð¸ÑÑ‹** (Ñ‚Ñ€ÐµÑ‚ÑŒÐµÑÑ‚Ð¾Ñ€Ð¾Ð½Ð½Ð¸Ðµ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸)

**ÐšÐ°Ð¶Ð´Ñ‹Ð¹ ÑƒÐ·ÐµÐ» ÑÐ°Ð¼ ÑÐµÐ±Ñ Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚**, Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€ÑƒÑÑÑŒ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ Ñ‡ÐµÑ€ÐµÐ· **NODE PASSPORT**.

---

### 1.2. ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾Ñ‚Ð¾Ñ‚Ð¸Ð¿ (Reference Architecture)

Node Registry Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ Ð·Ð°Ð¸Ð¼ÑÑ‚Ð²ÑƒÐµÑ‚ Ð¼Ð¾Ð´ÐµÐ»ÑŒ **Kubernetes Node Registry**:

| Kubernetes | AI_TEAM | ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ |
|------------|---------|------------|
| **Node** | **Node** | Ð˜ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ (compute unit) |
| **Node Spec** | **Node Passport** | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÐµÐ¹ ÑƒÐ·Ð»Ð° |
| **Node Status** | **Runtime Status** | Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ ÑƒÐ·Ð»Ð° |
| **Kubelet** | **Node Runtime** | ÐÐ³ÐµÐ½Ñ‚, Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‰Ð¸Ð¹ Ð½Ð° ÑƒÐ·Ð»Ðµ |
| **Heartbeat** | **Node Heartbeat** | ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¶Ð¸Ð²Ð¾ÑÑ‚Ð¸ ÑƒÐ·Ð»Ð° |
| **Scheduler** | **Orchestrator** | ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡ Ð½Ð° ÑƒÐ·Ð»Ñ‹ |
| **etcd** | **etcd / Consul** | Ð¥Ñ€Ð°Ð½Ð¸Ð»Ð¸Ñ‰Ðµ Ñ€ÐµÐµÑÑ‚Ñ€Ð° |

**Ð’Ñ‹Ð²Ð¾Ð´**: Node Registry Ð² AI_TEAM â€” ÑÑ‚Ð¾ **Ð´Ð¾Ð¼ÐµÐ½Ð½Ð¾-Ð°Ð´Ð°Ð¿Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Kubernetes Node Registry**.

---

### 1.3. ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ ÑÑ‚Ð¾ ÐÐ• Ð¸Ð·Ð¾Ð±Ñ€ÐµÑ‚ÐµÐ½Ð¸Ðµ Ð²ÐµÐ»Ð¾ÑÐ¸Ð¿ÐµÐ´Ð°

**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°**, ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ñ€ÐµÑˆÐ°ÐµÑ‚ Node Registry:
- Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÑƒÐ·Ð»Ð¾Ð²
- Ð¥Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¸Ñ… Ñ…Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸Ðº
- ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°
- Ð£Ð´Ð°Ð»ÐµÐ½Ð¸Ðµ "Ð¼Ñ‘Ñ€Ñ‚Ð²Ñ‹Ñ…" ÑƒÐ·Ð»Ð¾Ð²
- Ð’Ñ‹Ð±Ð¾Ñ€ ÑƒÐ·Ð»Ð¾Ð² Ð¿Ð¾ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑÐ¼ (capability matching)

**ÑƒÐ¶Ðµ Ñ€ÐµÑˆÐµÐ½Ð° Ð² Kubernetes** Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð¼Ð¸Ð»Ð»Ð¸Ð¾Ð½Ð°Ð¼Ð¸ production ÑÐ¸ÑÑ‚ÐµÐ¼.

**AI_TEAM**:
- âœ… ÐÐ• Ð¼ÐµÐ½ÑÐµÑ‚ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Registry
- âœ… ÐÐ• Ð¿ÐµÑ€ÐµÐ¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¸ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ð¸
- âœ… ÐÐ´Ð°Ð¿Ñ‚Ð¸Ñ€ÑƒÐµÑ‚ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¿Ð¾Ð´ AI-Ð´Ð¾Ð¼ÐµÐ½ (NODE PASSPORT Ð²Ð¼ÐµÑÑ‚Ð¾ Node Spec)

**Ð­Ñ‚Ð¾ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ð° "Ð“Ð¾Ñ‚Ð¾Ð²Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð¿ÐµÑ€Ð²Ð¸Ñ‡Ð½Ñ‹".**

---

### 1.4. Ð Ð¾Ð»ÑŒ Node Registry Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ

**Node Registry** ÑÐ²Ð»ÑÐµÑ‚ÑÑ:

1. **Ð•Ð´Ð¸Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð¼ Ð¿Ñ€Ð°Ð²Ð´Ñ‹ Ð¾ ÑÐ¾ÑÑ‚Ð°Ð²Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹** (SSOT Ð´Ð»Ñ ÑƒÐ·Ð»Ð¾Ð²)
2. **Ð¢Ð¾Ñ‡ÐºÐ¾Ð¹ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸** Ð¼ÐµÐ¶Ð´Ñƒ:
   - Process Cards (Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ¾Ð²)
   - ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð¾Ð¼ (Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð·Ð°Ð´Ð°Ñ‡)
   - Ð ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑÐ¼Ð¸ ÑƒÐ·Ð»Ð¾Ð² (NODE PASSPORT)
3. **ÐžÑÐ½Ð¾Ð²Ð¾Ð¹ Ð´Ð»Ñ**:
   - ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡ Ð½Ð° Ð¿Ð¾Ð´Ñ…Ð¾Ð´ÑÑ‰Ð¸Ðµ ÑƒÐ·Ð»Ñ‹
   - ÐœÐ°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹
   - ÐžÑ‚ÐºÐ°Ð·Ð¾ÑƒÑÑ‚Ð¾Ð¹Ñ‡Ð¸Ð²Ð¾ÑÑ‚Ð¸ (Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ offline ÑƒÐ·Ð»Ð¾Ð²)

---

## Ð§ÐÐ¡Ð¢Ð¬ 2. Ð¢Ð•Ð¥ÐÐ˜Ð§Ð•Ð¡ÐšÐžÐ• Ð—ÐÐ”ÐÐÐ˜Ð•

### 2.1. Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñ‹ Ð¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸

**ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸** (Reference Documentation):

1. **Kubernetes Official Documentation**:
   - [Nodes](https://kubernetes.io/docs/concepts/architecture/nodes/)
   - [API Server](https://kubernetes.io/docs/concepts/overview/kubernetes-api/)
   - [Leases & Heartbeats](https://kubernetes.io/docs/concepts/architecture/leases/)

2. **CNCF Architecture Patterns**:
   - [etcd Documentation](https://etcd.io/docs/)
   - [Cloud Native Patterns](https://www.cncf.io/projects/)

3. **Consul Service Registry**:
   - [Service Discovery](https://www.consul.io/docs/discovery)
   - [Health Checks](https://www.consul.io/docs/discovery/checks)

**â— Ð’ÐÐ–ÐÐž**: Ð­Ñ‚Ð¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ ÑÐ²Ð»ÑÑŽÑ‚ÑÑ **Ð°Ñ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ð¾Ð¹ Ð¾ÑÐ½Ð¾Ð²Ð¾Ð¹** Ð¸ **Ð½Ðµ Ð´ÑƒÐ±Ð»Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ** Ð² AI_TEAM.
ÐŸÑ€Ð¸ Ð¸Ð¼Ð¿Ð»ÐµÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸ ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐž Ð¸Ð·ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ðµ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¸.

---

### 2.2. Ð¡Ð¿Ð¾ÑÐ¾Ð±Ñ‹ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Node Registry

#### 2.2.1. MVP-Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ (Bootstrap)

**ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ**: Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ ÑÑ‚Ð°Ñ€Ñ‚ Ð±ÐµÐ· Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹.

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°**:
- âœ… Ð ÐµÐµÑÑ‚Ñ€ Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÐµÑ‚ÑÑ **Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°** (in-process)
- âœ… Ð¥Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ: **in-memory** map / dict / table
- âœ… Heartbeat: Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¿ÐµÑ€ÐµÑ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÑƒÐ·Ð»Ð¾Ð²
- âœ… TTL: ÑƒÐ·ÐµÐ» ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ offline Ð¿Ñ€Ð¸ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¸Ð¸ timeout

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹**:
```python
# Ð’Ð½ÑƒÑ‚Ñ€Ð¸ Orchestrator
class InMemoryNodeRegistry:
    def __init__(self):
        self.nodes: Dict[str, NodePassport] = {}
        self.last_seen: Dict[str, datetime] = {}
        self.ttl_seconds = 30  # Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð°

    def register_node(self, passport: NodePassport):
        self.nodes[passport.metadata.uid] = passport
        self.last_seen[passport.metadata.uid] = datetime.utcnow()

    def update_heartbeat(self, node_id: str):
        self.last_seen[node_id] = datetime.utcnow()

    def get_alive_nodes(self) -> List[NodePassport]:
        now = datetime.utcnow()
        return [
            passport for node_id, passport in self.nodes.items()
            if (now - self.last_seen[node_id]).total_seconds() < self.ttl_seconds
        ]
```

**ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ MVP**:
- âŒ ÐÐµ distributed (Ð½ÐµÑ‚ Ð¾Ñ‚ÐºÐ°Ð·Ð¾ÑƒÑÑ‚Ð¾Ð¹Ñ‡Ð¸Ð²Ð¾ÑÑ‚Ð¸ Registry)
- âŒ Ð”Ð°Ð½Ð½Ñ‹Ðµ Ñ‚ÐµÑ€ÑÑŽÑ‚ÑÑ Ð¿Ñ€Ð¸ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐµ ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°
- âŒ ÐÐµ Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð½Ð° Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Orchestrator instances

**ÐšÐ¾Ð³Ð´Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ**: ÐÐ° ÑÑ‚Ð°Ð¿Ðµ Ð¿Ñ€Ð¾Ñ‚Ð¾Ñ‚Ð¸Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ð¿ÐµÑ€Ð²Ð¾Ð³Ð¾ MVP.

---

#### 2.2.2. Production-Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ (Recommended)

**Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ A: etcd (Kubernetes-style)**

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°**:
- âœ… Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ **etcd** ÐºÐ°Ðº distributed key-value store
- âœ… NODE PASSPORT Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑÑ ÐºÐ°Ðº JSON/YAML document
- âœ… TTL Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÐµÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· **etcd Leases** (Ð²ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ñ‹Ð¹ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼)
- âœ… **Watch API** Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ (node up/down)

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÐºÐ»ÑŽÑ‡ÐµÐ¹ Ð² etcd**:
```
/ai_team/registry/nodes/{node_id} â†’ NODE PASSPORT (JSON)
/ai_team/registry/leases/{node_id} â†’ Lease (TTL=30s)
```

**ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°**:
- âœ… Distributed consensus (Raft)
- âœ… Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ (multi-master)
- âœ… Watch API Ð´Ð»Ñ real-time Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¹
- âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐµÐ½Ð¾ Ð² production (Kubernetes Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ etcd)

**Ð‘Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸**:
- Python: `python-etcd3`, `etcd3-py`
- Go: `go.etcd.io/etcd/client/v3`

---

**Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ B: Consul**

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°**:
- âœ… Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ **Consul Service Registry**
- âœ… NODE PASSPORT Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑÑ ÐºÐ°Ðº **service metadata**
- âœ… **Health checks** Ð²ÑÑ‚Ñ€Ð¾ÐµÐ½Ñ‹ (HTTP, TCP, gRPC)
- âœ… **Service Discovery** Ð¸Ð· ÐºÐ¾Ñ€Ð¾Ð±ÐºÐ¸

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð² Consul**:
```json
{
  "ID": "ai-agent-coder-01",
  "Name": "ai-agent-coder-01",
  "Tags": ["agent", "code_generation", "python"],
  "Meta": {
    "node_passport": "{...}"
  },
  "Check": {
    "HTTP": "http://agent:8080/health",
    "Interval": "10s",
    "Timeout": "2s"
  }
}
```

**ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°**:
- âœ… Service Discovery Ð²ÑÑ‚Ñ€Ð¾ÐµÐ½
- âœ… Health checks Ð¸Ð· ÐºÐ¾Ñ€Ð¾Ð±ÐºÐ¸
- âœ… DNS Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ (Ð¼Ð¾Ð¶Ð½Ð¾ Ñ€ÐµÐ·Ð¾Ð»Ð²Ð¸Ñ‚ÑŒ ÑƒÐ·Ð»Ñ‹ Ñ‡ÐµÑ€ÐµÐ· DNS)
- âœ… Web UI Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°

**Ð‘Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸**:
- Python: `python-consul`, `py-consul`
- Go: `github.com/hashicorp/consul/api`

---

**ðŸ‘‰ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ**: ÐžÐ±Ð° Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð° (etcd, Consul) ÑÑ‡Ð¸Ñ‚Ð°ÑŽÑ‚ÑÑ **Ð²Ð°Ð»Ð¸Ð´Ð½Ñ‹Ð¼Ð¸ Ð¸ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ñ‹Ð¼Ð¸**.

**Ð’Ñ‹Ð±Ð¾Ñ€ Ð·Ð°Ð²Ð¸ÑÐ¸Ñ‚ Ð¾Ñ‚**:
- Ð•ÑÐ»Ð¸ ÑƒÐ¶Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Kubernetes â†’ **etcd** (natural fit)
- Ð•ÑÐ»Ð¸ Ð½ÑƒÐ¶ÐµÐ½ Service Discovery + Health Checks â†’ **Consul** (more batteries included)
- Ð•ÑÐ»Ð¸ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° â†’ **etcd** (Ð»ÐµÐ³ÐºÐ¾Ð²ÐµÑÐ½ÐµÐµ)

---

### 2.3. Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÑƒÐ·Ð»Ð°

**ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑˆÐ°Ð³Ð¸** (Ð¶Ð¸Ð·Ð½ÐµÐ½Ð½Ñ‹Ð¹ Ñ†Ð¸ÐºÐ» ÑƒÐ·Ð»Ð°):

```
1. [Ð£Ð·ÐµÐ» ÑÑ‚Ð°Ñ€Ñ‚ÑƒÐµÑ‚]
   â†“
2. [Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ñ‚ ÑÐ²Ð¾Ð¹ NODE PASSPORT]
   â†’ Ð—Ð°Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ metadata (UID, name, labels)
   â†’ Ð—Ð°Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ spec (capabilities, resources, endpoint)
   â†’ Ð—Ð°Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ status (phase=Pending, conditions)
   â†“
3. [Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð² Registry]
   â†’ ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ NODE PASSPORT Ð² Registry
   â†’ Registry Ð²Ð°Ð»Ð¸Ð´Ð¸Ñ€ÑƒÐµÑ‚ Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚
   â†“
4. [ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ heartbeat]
   â†’ ÐŸÐµÑ€Ð¸Ð¾Ð´Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ Lease (ÐºÐ°Ð¶Ð´Ñ‹Ðµ 10s)
   â†’ Registry Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ last_seen timestamp
   â†“
5. [ÐŸÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ Ð² phase: Running]
   â†’ ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ status.phase = "Running"
   â†’ ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ status.conditions[Ready] = True
   â†“
6. [Ð“Ð¾Ñ‚Ð¾Ð² Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ñ‚ÑŒ Ð·Ð°Ð´Ð°Ñ‡Ð¸]
```

**ÐŸÐ¾Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸ ÑÐ±Ð¾Ðµ**:

| Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ðµ | Ð ÐµÐ°ÐºÑ†Ð¸Ñ Registry | ÐŸÐ¾ÑÐ»ÐµÐ´ÑÑ‚Ð²Ð¸Ðµ |
|---------|------------------|-------------|
| Heartbeat Ð¿Ñ€Ð¾Ð¿Ð°Ð» | Ð§ÐµÑ€ÐµÐ· N ÑÐµÐºÑƒÐ½Ð´ â†’ status.phase = "NotReady" | Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ðµ Ð½Ð°Ð·Ð½Ð°Ñ‡Ð°ÑŽÑ‚ÑÑ |
| TTL Ð¸ÑÑ‚Ñ‘Ðº | status.phase = "Offline" | Ð£Ð·ÐµÐ» ÑƒÐ±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ Ð¸Ð· Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… |
| Ð£Ð·ÐµÐ» Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð»ÑÑ | Heartbeat Ð²Ð¾Ð·Ð¾Ð±Ð½Ð¾Ð²Ð¸Ð»ÑÑ â†’ phase = "Running" | Ð¡Ð½Ð¾Ð²Ð° Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ð·Ð°Ð´Ð°Ñ‡Ð¸ |

**ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹** (Ð¸Ð· `config/node_registry.yaml`):
```yaml
heartbeat:
  interval_seconds: 10      # Ð£Ð·ÐµÐ» Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ heartbeat ÐºÐ°Ð¶Ð´Ñ‹Ðµ 10s
  ttl_seconds: 30           # TTL = 3x interval (Ð±ÑƒÑ„ÐµÑ€ Ð´Ð»Ñ ÑÐ±Ð¾ÐµÐ² ÑÐµÑ‚Ð¸)
  grace_period_seconds: 60  # Ð¡ÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ offline ÑƒÐ·Ð»Ñ‹
```

---

### 2.4. Ð”Ð°Ð½Ð½Ñ‹Ðµ, Ñ…Ñ€Ð°Ð½Ð¸Ð¼Ñ‹Ðµ Ð² Ñ€ÐµÐµÑÑ‚Ñ€Ðµ

**Registry ÐÐ• Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ñ€ÐµÑ‚Ð¸Ñ€ÑƒÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ**, Ð° Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ NODE PASSPORT ÐºÐ°Ðº ÐµÑÑ‚ÑŒ:

```python
@dataclass
class RegistryEntry:
    node_id: str                  # metadata.uid
    node_kind: str                # metadata.nodeType
    passport: NodePassport        # ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚ (Ð¸Ð· SSOT)
    last_seen: datetime           # Timestamp Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ heartbeat
    health_state: HealthState     # ALIVE | NOT_READY | OFFLINE
    registered_at: datetime       # Ð’Ñ€ÐµÐ¼Ñ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸
```

**ÐŸÐ¾Ð»Ñ Registry Entry**:

| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| `node_id` | string (UUID) | UID ÑƒÐ·Ð»Ð° Ð¸Ð· metadata.uid |
| `node_kind` | enum | Ð¢Ð¸Ð¿ ÑƒÐ·Ð»Ð°: agent, orchestrator, storage, gateway |
| `passport` | NodePassport | **ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ NODE PASSPORT** (Ð½Ðµ Ð¼Ð¾Ð´Ð¸Ñ„Ð¸Ñ†Ð¸Ñ€ÑƒÐµÑ‚ÑÑ) |
| `last_seen` | datetime | Timestamp Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ heartbeat |
| `health_state` | enum | ALIVE, NOT_READY, OFFLINE |
| `registered_at` | datetime | Ð’Ñ€ÐµÐ¼Ñ Ð¿ÐµÑ€Ð²Ð¾Ð¹ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ |

**Ð’ÑÑ Ð»Ð¾Ð³Ð¸ÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ** â€” Ð½Ð° ÑÑ‚Ð¾Ñ€Ð¾Ð½Ðµ **ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð°**.
Registry Ð»Ð¸ÑˆÑŒ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ.

---

### 2.5. ÐŸÐ¾Ð¸ÑÐº Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÑƒÐ·Ð»Ð¾Ð²

**Node Registry Ð¾Ð±ÑÐ·Ð°Ð½ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°Ñ‚ÑŒ**:

1. **ÐŸÐ¾Ð¸ÑÐº Ð¿Ð¾ kind** (Ñ‚Ð¸Ð¿ ÑƒÐ·Ð»Ð°)
   ```python
   registry.find_nodes(kind="agent")
   ```

2. **Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ capabilities** (Ñ‡ÐµÑ€ÐµÐ· labels)
   ```python
   selector = {
       "matchLabels": {
           "capability.code_generation": "true",
           "capability.python": "true"
       }
   }
   registry.find_nodes(selector=selector)
   ```

3. **Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ constraints** (Ñ‡ÐµÑ€ÐµÐ· matchExpressions)
   ```python
   selector = {
       "matchExpressions": [
           {"key": "zone", "operator": "In", "values": ["eu-west-1"]},
           {"key": "memory", "operator": "Gt", "values": ["4Gi"]}
       ]
   }
   registry.find_nodes(selector=selector)
   ```

4. **Ð˜ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ offline / unhealthy ÑƒÐ·Ð»Ð¾Ð²**
   ```python
   registry.find_nodes(only_healthy=True)
   ```

**ÐÐ»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼ Ð²Ñ‹Ð±Ð¾Ñ€Ð° ÑƒÐ·Ð»Ð°** (scheduling):
- âŒ ÐÐ• Ñ€ÐµÐ°Ð»Ð¸Ð·ÑƒÐµÑ‚ÑÑ Ð² Registry
- âœ… Ð ÐµÐ°Ð»Ð¸Ð·ÑƒÐµÑ‚ÑÑ **Ð¸ÑÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð² ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ðµ**
- Registry Ð»Ð¸ÑˆÑŒ Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ **ÑÐ¿Ð¸ÑÐ¾Ðº Ð¿Ð¾Ð´Ñ…Ð¾Ð´ÑÑ‰Ð¸Ñ… ÑƒÐ·Ð»Ð¾Ð²**

**ÐŸÑ€Ð¸Ð¼ÐµÑ€**:
```python
# Orchestrator
candidates = registry.find_nodes(
    kind="agent",
    selector={"matchLabels": {"capability.code_generation": "true"}},
    only_healthy=True
)

# Orchestrator Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ ÑÐ²Ð¾Ð¹ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼ Ð²Ñ‹Ð±Ð¾Ñ€Ð°
best_node = scheduler.select_best(candidates)  # Ð¿Ð¾ currentTasks, resources, etc.
```

---

### 2.6. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ð¹ ÐºÐ¾Ð´ Ð¸ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸

**Ð Ð°Ð·Ñ€ÐµÑˆÑ‘Ð½Ð½Ñ‹Ðµ Ð¸ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÐ¼Ñ‹Ðµ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸**:

| Ð¢ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ñ | Ð‘Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ° | Ð¯Ð·Ñ‹Ðº | ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ |
|------------|------------|------|------------|
| **Kubernetes** | `kubernetes` | Python | Kubernetes client (Ð´Ð»Ñ etcd patterns) |
| **etcd** | `etcd3`, `python-etcd3` | Python | etcd client |
| **Consul** | `python-consul`, `py-consul` | Python | Consul client |
| **Validation** | `pydantic` | Python | NODE PASSPORT validation |
| **API** | `FastAPI` | Python | Ð•ÑÐ»Ð¸ Registry Ð²Ñ‹Ð½Ð¾ÑÐ¸Ñ‚ÑÑ Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÐµÑ€Ð²Ð¸Ñ |
| **Metrics** | `prometheus_client` | Python | Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð¼ÐµÑ‚Ñ€Ð¸Ðº Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° |

**â— Ð—ÐÐŸÐ Ð•Ð©Ð•ÐÐž**:
- âŒ ÐŸÐ¸ÑÐ°Ñ‚ÑŒ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ distributed registry
- âŒ ÐŸÐ¸ÑÐ°Ñ‚ÑŒ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ consensus-Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼
- âŒ ÐŸÐ¸ÑÐ°Ñ‚ÑŒ ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ heartbeat-Ð¿Ñ€Ð¾Ñ‚Ð¾ÐºÐ¾Ð»
- âŒ Ð˜Ð·Ð¾Ð±Ñ€ÐµÑ‚Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚Ð¾Ð²

**ÐŸÑ€Ð°Ð²Ð¸Ð»Ð¾**: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ðµ Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ¸ Ð¸ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð¸Ð· Kubernetes/Consul.

---

### 2.7. Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ MindBus Protocol

**Node Registry**:
- âŒ ÐÐ• ÑƒÑ‡Ð°ÑÑ‚Ð²ÑƒÐµÑ‚ Ð² Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¼ÐµÐ¶Ð´Ñƒ ÑƒÐ·Ð»Ð°Ð¼Ð¸
- âŒ ÐÐ• ÑÐ²Ð»ÑÐµÑ‚ÑÑ Ð±Ñ€Ð¾ÐºÐµÑ€Ð¾Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
- âŒ ÐÐ• Ð²Ð¼ÐµÑˆÐ¸Ð²Ð°ÐµÑ‚ÑÑ Ð² ÐºÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ†Ð¸ÑŽ Ñ‡ÐµÑ€ÐµÐ· MindBus

**Ð¡Ð²ÑÐ·ÑŒ**:
- **Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ** â†’ Node Registry (control plane)
- **Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð¸ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ** â†’ MindBus / RabbitMQ (data plane)

**ÐÐ½Ð°Ð»Ð¾Ð³Ð¸Ñ Ñ Kubernetes**:
```
Kubernetes          AI_TEAM
----------          -------
etcd                Node Registry (control plane)
Network (CNI)       MindBus / RabbitMQ (data plane)
```

**Ð§Ñ‘Ñ‚ÐºÐ¾Ðµ Ñ€Ð°Ð·Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸**:
- Registry Ð·Ð½Ð°ÐµÑ‚ "ÐºÑ‚Ð¾ ÐµÑÑ‚ÑŒ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ðµ"
- MindBus Ð´Ð¾ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ "Ñ‡Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ"

---

## Ð§ÐÐ¡Ð¢Ð¬ 3. Ð’ÐžÐŸÐ ÐžÐ¡Ð«, Ð Ð˜Ð¡ÐšÐ˜ Ð˜ Ð‘Ð£Ð”Ð£Ð©Ð•Ð• Ð ÐÐ—Ð’Ð˜Ð¢Ð˜Ð•

### 3.1. ÐœÐ°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

**Ð’Ð¾Ð¿Ñ€Ð¾Ñ**: Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸ ÑÐ¾Ñ‚Ð½ÑÑ…/Ñ‚Ñ‹ÑÑÑ‡Ð°Ñ… ÑƒÐ·Ð»Ð¾Ð²?

**ÐžÑ‚Ð²ÐµÑ‚**: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ **etcd** / **Consul** (Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐµÐ½Ð¾ Kubernetes).

**Benchmark Ð´Ð°Ð½Ð½Ñ‹Ðµ** (Ð¸Ð· Kubernetes):
- etcd: ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ñ **10,000+ ÑƒÐ·Ð»Ð¾Ð²**
- Consul: ÑÑ‚Ð°Ð±Ð¸Ð»ÑŒÐ½Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ñ **5,000+ services**

**Ð”Ð»Ñ AI_TEAM**:
- MVP (Ð´Ð¾ 100 ÑƒÐ·Ð»Ð¾Ð²) â†’ in-memory Registry
- Production (100-1000 ÑƒÐ·Ð»Ð¾Ð²) â†’ etcd
- Large scale (1000+ ÑƒÐ·Ð»Ð¾Ð²) â†’ etcd cluster (3-5 nodes)

---

### 3.2. Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ð¸ Ð´Ð¾Ð²ÐµÑ€Ð¸Ðµ

**Ð’Ð¾Ð¿Ñ€Ð¾Ñ**: ÐœÐ¾Ð¶ÐµÑ‚ Ð»Ð¸ ÑƒÐ·ÐµÐ» ÑÐ¾Ð²Ñ€Ð°Ñ‚ÑŒ Ð¾ ÑÐ²Ð¾Ð¸Ñ… Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑÑ…?

**ÐŸÐ¾Ð´Ñ…Ð¾Ð´**:
- **MVP**: Ð”Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÑƒÐ·Ð»Ð°Ð¼ (trust by default)
- **Production**: Validation policies + infrastructure control
- **Future**: Capability verification Ñ‡ÐµÑ€ÐµÐ· Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸** (future):
```
1. Ð£Ð·ÐµÐ» Ð·Ð°ÑÐ²Ð»ÑÐµÑ‚: "capability.code_generation=true"
2. ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ñ‚ÐµÑÑ‚Ð¾Ð²ÑƒÑŽ Ð·Ð°Ð´Ð°Ñ‡Ñƒ: "ÐÐ°Ð¿Ð¸ÑˆÐ¸ Hello World Ð½Ð° Python"
3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚
4. Ð•ÑÐ»Ð¸ OK â†’ capability Ð¿Ð¾Ð´Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð°
5. Ð•ÑÐ»Ð¸ FAIL â†’ capability Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÑÐµÑ‚ÑÑ, ÑƒÐ·ÐµÐ» Ð¿Ð¾Ð¼ÐµÑ‡ÐµÐ½ ÐºÐ°Ðº "untrusted"
```

**Ð”Ð»Ñ MVP**: ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÑÑ‚Ð¾Ñ‚ Ð¼ÐµÑ…Ð°Ð½Ð¸Ð·Ð¼ (Ð´Ð¾Ð±Ð°Ð²Ð¸Ð¼ Ð² v2.0).

---

### 3.3. Ð¡Ð¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð²ÐµÑ€ÑÐ¸Ð¹

**Ð’Ð¾Ð¿Ñ€Ð¾Ñ**: Ð§Ñ‚Ð¾ ÐµÑÐ»Ð¸ NODE PASSPORT Ð½Ð¾Ð²Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸Ð¸?

**ÐŸÐ¾Ð´Ñ…Ð¾Ð´**:

1. **Versioning Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚Ð°**:
   ```json
   {
     "apiVersion": "ai_team.io/v1",
     "kind": "NodePassport",
     "metadata": { ... }
   }
   ```

2. **Backward compatibility**:
   - Registry Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ **Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð²ÐµÑ€ÑÐ¸Ð¹ Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚Ð°** Ð¾Ð´Ð½Ð¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾
   - ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ñ Ð¸Ð· ÑÑ‚Ð°Ñ€Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸Ð¸ Ð² Ð½Ð¾Ð²ÑƒÑŽ (adapter pattern)

3. **ÐžÑ‚ÐºÐ°Ð· Ð² Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸**:
   - Ð•ÑÐ»Ð¸ Ð²ÐµÑ€ÑÐ¸Ñ Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚Ð° **Ð½ÐµÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð°** â†’ Registry Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÑÐµÑ‚ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸ÑŽ
   - Ð£Ð·ÐµÐ» Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ Ð¾ÑˆÐ¸Ð±ÐºÑƒ Ð¸ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¾Ð±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒÑÑ

**ÐŸÑ€Ð¸Ð¼ÐµÑ€**:
```
Node Passport v1.0 â†’ Registry v1.0 âœ…
Node Passport v1.1 â†’ Registry v1.0 âœ… (backward compatible)
Node Passport v2.0 â†’ Registry v1.0 âŒ (breaking change, Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Registry)
```

---

### 3.4. ÐŸÐ¾Ñ‚ÐµÑ€Ñ Registry

**Ð’Ð¾Ð¿Ñ€Ð¾Ñ**: Ð§Ñ‚Ð¾ ÐµÑÐ»Ð¸ Registry Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½?

**ÐŸÐ¾Ð´Ñ…Ð¾Ð´**:

1. **Ð£Ð·Ð»Ñ‹ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÑŽÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ**:
   - Ð£Ð·ÐµÐ» Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒÑÑ, Ð½Ð¾ **Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÑ‚ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ñ… Ð·Ð°Ð´Ð°Ñ‡**
   - Heartbeat Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÑ‚ÑÑ (ÐºÑÑˆÐ¸Ñ€ÑƒÐµÑ‚ÑÑ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾)

2. **Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ðµ Ð½Ð°Ð·Ð½Ð°Ñ‡Ð°ÑŽÑ‚ÑÑ Ð½Ð¾Ð²Ñ‹Ð¼ ÑƒÐ·Ð»Ð°Ð¼**:
   - ÐžÑ€ÐºÐµÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð½Ð°Ð¹Ñ‚Ð¸ ÑƒÐ·Ð»Ñ‹ â†’ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð² Ð¾Ñ‡ÐµÑ€ÐµÐ´Ð¸
   - ÐšÐ°Ðº Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Registry Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ÑÑ â†’ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ð°Ð·Ð½Ð°Ñ‡Ð°ÑŽÑ‚ÑÑ

3. **Registry Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ÑÑ**:
   - etcd/Consul Ð¸Ð¼ÐµÑŽÑ‚ **distributed consensus** â†’ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ
   - Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð½Ðµ Ñ‚ÐµÑ€ÑÑŽÑ‚ÑÑ (replicated storage)

**ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ð°Ñ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ**: Registry â€” ÑÑ‚Ð¾ stateless ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ (ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð² etcd/Consul).

---

### 3.5. Ð­Ð²Ð¾Ð»ÑŽÑ†Ð¸Ñ Registry

**Ð’ Ð±ÑƒÐ´ÑƒÑ‰ÐµÐ¼ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾**:

1. **CRD-like Ð¼Ð¾Ð´ÐµÐ»ÑŒ** (ÐºÐ°Ðº Ð² Kubernetes):
   - ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ðµ Ñ‚Ð¸Ð¿Ñ‹ ÑƒÐ·Ð»Ð¾Ð² (Custom Node Types)
   - Ð Ð°ÑÑˆÐ¸Ñ€ÑÐµÐ¼Ð¾ÑÑ‚ÑŒ ÑÑ…ÐµÐ¼Ñ‹ Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚Ð°

2. **Dynamic capabilities**:
   - Ð£Ð·ÐµÐ» Ð¼Ð¾Ð¶ÐµÑ‚ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑ‚ÑŒ/ÑƒÐ´Ð°Ð»ÑÑ‚ÑŒ capabilities Ð² runtime
   - Registry Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°ÐµÑ‚ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ

3. **Policy-based scheduling**:
   - ÐŸÑ€Ð°Ð²Ð¸Ð»Ð° Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð·Ð°Ð´Ð°Ñ‡ (affinity, anti-affinity)
   - Taints and Tolerations (Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ ÑƒÐ·Ð»Ð¾Ð²)

4. **Federation** (Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Registry):
   - ÐœÑƒÐ»ÑŒÑ‚Ð¸-Ñ€ÐµÐ³Ð¸Ð¾Ð½ deployment
   - ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ñ€ÐµÐ³Ð¸Ð¾Ð½ Ð¸Ð¼ÐµÐµÑ‚ ÑÐ²Ð¾Ð¹ Registry
   - Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Registry ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ

**Ð”Ð»Ñ MVP**: Ð­Ñ‚Ð¸ Ñ„Ð¸Ñ‡Ð¸ ÐÐ• Ð½ÑƒÐ¶Ð½Ñ‹. Ð”Ð¾Ð±Ð°Ð²Ð»ÑÑŽÑ‚ÑÑ Ð¿Ð¾ Ð¼ÐµÑ€Ðµ Ñ€Ð¾ÑÑ‚Ð° ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹.

---

## Ð¤Ð˜ÐÐÐ›Ð¬ÐÐžÐ• Ð—ÐÐšÐ›Ð®Ð§Ð•ÐÐ˜Ð•

### âœ… Ð§Ñ‚Ð¾ ÑƒÑ‚Ð²ÐµÑ€Ð¶Ð´Ð°ÐµÑ‚ÑÑ

1. **Node Registry Ð² AI_TEAM** â€” ÑÑ‚Ð¾ **Ð°Ð´Ð°Ð¿Ñ‚Ð°Ñ†Ð¸Ñ Kubernetes Node Registry** Ð´Ð»Ñ AI-Ð´Ð¾Ð¼ÐµÐ½Ð°
2. **Ð“Ð¾Ñ‚Ð¾Ð²Ð°Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð¸ ÐºÐ¾Ð´** Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ (etcd, Consul, Kubernetes patterns)
3. **Ð¡Ð¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ð°Ñ Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ** Ð´Ð¾Ð¿ÑƒÑÐºÐ°ÐµÑ‚ÑÑ **Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ð´Ð¾Ð¼ÐµÐ½Ð½Ð¾Ð¹ Ð»Ð¾Ð³Ð¸ÐºÐ¸** (Ð°Ð´Ð°Ð¿Ñ‚Ð°Ñ†Ð¸Ñ NODE PASSPORT)
4. **ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð½Ð¾ Ð²ÐµÐ»Ð¾ÑÐ¸Ð¿ÐµÐ´ ÐÐ• Ð¸Ð·Ð¾Ð±Ñ€ÐµÑ‚Ð°ÐµÑ‚ÑÑ**

---

### ðŸŽ¯ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÐ¼Ð°Ñ Ð¸Ð¼Ð¿Ð»ÐµÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ

**Ð”Ð»Ñ MVP**:
- âœ… In-memory Registry Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Orchestrator
- âœ… Heartbeat Ñ‡ÐµÑ€ÐµÐ· Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð¸Ñ‡ÐµÑÐºÑƒÑŽ Ð¿ÐµÑ€ÐµÑ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸ÑŽ
- âœ… TTL = 30 ÑÐµÐºÑƒÐ½Ð´

**Ð”Ð»Ñ Production**:
- âœ… etcd ÐºÐ°Ðº distributed key-value store
- âœ… Lease mechanism Ð´Ð»Ñ heartbeat
- âœ… Watch API Ð´Ð»Ñ real-time ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹

**Timeline**:
- MVP: 1-2 Ð½ÐµÐ´ÐµÐ»Ð¸ (in-memory Ñ€ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ)
- Production: +2-3 Ð½ÐµÐ´ÐµÐ»Ð¸ (Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ etcd)

---

### ðŸ“„ Ð­Ñ‚Ð¾Ñ‚ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚ Ñ„Ð¸ÐºÑÐ¸Ñ€ÑƒÐµÑ‚

**Node Registry** ÐºÐ°Ðº **ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½ÑƒÑŽ, Ð·Ñ€ÐµÐ»ÑƒÑŽ Ð¸ Ñ€Ð°ÑÑˆÐ¸Ñ€ÑÐµÐ¼ÑƒÑŽ** Ñ‡Ð°ÑÑ‚ÑŒ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ñ‹ AI_TEAM.

**ÐŸÑ€Ð¸Ð½Ñ†Ð¸Ð¿ "Ð“Ð¾Ñ‚Ð¾Ð²Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ Ð¿ÐµÑ€Ð²Ð¸Ñ‡Ð½Ñ‹"** ÑÐ¾Ð±Ð»ÑŽÐ´Ñ‘Ð½ Ð½Ð° 100%.

---

**Ð’ÐµÑ€ÑÐ¸Ñ**: 1.0
**Ð”Ð°Ñ‚Ð°**: 2025-12-15
**ÐÐ²Ñ‚Ð¾Ñ€Ñ‹**: AI_TEAM Core Team
**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ**: âœ… Ð£Ñ‚Ð²ÐµÑ€Ð¶Ð´ÐµÐ½Ð¾ (Approved)
